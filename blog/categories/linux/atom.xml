<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Linux | Sojiro's Blog]]></title>
  <link href="http://sojiro14.github.io/blog/categories/linux/atom.xml" rel="self"/>
  <link href="http://sojiro14.github.io/"/>
  <updated>2015-05-24T15:50:19+09:00</updated>
  <id>http://sojiro14.github.io/</id>
  <author>
    <name><![CDATA[Sojiro]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Xdg-open コマンドとは]]></title>
    <link href="http://sojiro14.github.io/blog/2015/05/12/what-is-xdg-open-command/"/>
    <updated>2015-05-12T23:55:57+09:00</updated>
    <id>http://sojiro14.github.io/blog/2015/05/12/what-is-xdg-open-command</id>
    <content type="html"><![CDATA[<p>以前 <a href="http://blog.sojiro.me/blog/2015/05/10/the-second-step-of-yeoman/">初めてのYeoman (Grunt/Bowerを使ってみる)</a> というエントリで Grunt を実行したときに</p>

<pre><code class="bash">Warning: Command failed: /home/sojiro/yeoman/angular_fullstack/node_modules/open/vendor/xdg-open: line 584: xdg-mime: コマンドが見つかりません
</code></pre>

<p>と怒られたことがあったので <code>xdg-open</code> コマンドについて少し調べてみます</p>

<h2>xdg-open コマンドのインストール</h2>

<p>xdg-open の実体はシェルスクリプトである</p>

<p>すんなりインストールできるかと思いきや普段の CentOS に入れるのに手こずってしまった</p>

<p>どうやら Ubuntu との相性が良いようなので Vagrant で Ubuntu を立ち上げてそこでインストールしてみる</p>

<h3>Ubuntu のセットアップ</h3>

<p>Vagrant で Ubuntu 環境をセットアップする</p>

<p>まずは box のインストールから</p>

<pre><code class="bash">$ vagrant box add ubuntu http://goo.gl/8kWkm
==&gt; box: Adding box 'ubuntu' (v0) for provider: 
   box: Downloading: http://goo.gl/8kWkm
==&gt; box: Successfully added box 'ubuntu' (v0) for 'virtualbox'!
</code></pre>

<pre><code class="bash">$ vagrant box list
centos64 (virtualbox, 0)
ubuntu   (virtualbox, 0)
</code></pre>

<p>box がセットアップできたら立ち上げまで行ってしまう</p>

<pre><code class="bash">$ mkdir ubuntu
$ cd ubuntu/
$ vagrant init ubuntu
A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.
$ ls
Vagrantfile
$ vagrant up
Bringing machine 'default' up with 'virtualbox' provider...
==&gt; default: Importing base box 'ubuntu'...
==&gt; default: Matching MAC address for NAT networking...
==&gt; default: Setting the name of the VM: ubuntu_default_1432117537476_54763
==&gt; default: Fixed port collision for 22 =&gt; 2222. Now on port 2200.
==&gt; default: Clearing any previously set network interfaces...
==&gt; default: Preparing network interfaces based on configuration...
   default: Adapter 1: nat
==&gt; default: Forwarding ports...
   default: 22 =&gt; 2200 (adapter 1)
==&gt; default: Booting VM...
==&gt; default: Waiting for machine to boot. This may take a few minutes...
</code></pre>

<p>立ち上がったら以下のコマンドで Ubuntu 環境に入り、インストールの準備が完了する</p>

<pre><code class="bash">$ vagrant ssh
Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-32-generic x86_64)

* Documentation:  https://help.ubuntu.com/

 System information as of Wed May 20 07:30:10 BRT 2015

 System load:  0.0               Processes:           73
 Usage of /:   11.7% of 7.87GB   Users logged in:     0
 Memory usage: 1%                IP address for eth0: 10.0.2.15
 Swap usage:   0%

 Graph this data and manage this system at https://landscape.canonical.com/

New release '14.04.2 LTS' available.
Run 'do-release-upgrade' to upgrade to it.
</code></pre>

<h3>インストール</h3>

<p>ここからいよいよ Ubuntu に <code>xdg-open</code> をインストールしていく</p>

<p>最初から入ってたらラッキーだなーと思いつつ打ってみる</p>

<pre><code class="bash">$ xdg-open
The program 'xdg-open' is currently not installed.  You can install it by typing:
sudo apt-get install xdg-utils
</code></pre>

<p>思いがけず大ヒントが返ってきたので従う</p>

<p>xdg-utils は <code>xdg-open</code> を内包するパッケージである</p>

<pre><code class="bash">$ sudo apt-get install xdg-utils
Reading package lists... Done
Building dependency tree
...
E: Unable to fetch some archives, maybe run apt-get update or try with --fix-missing?
</code></pre>

<p>エラーになってしまった</p>

<p>しかしまたヒントがあるので従う</p>

<pre><code class="bash">$ sudo apt-get install xdg-utils --fix-missing
Reading package lists... Done
Building dependency tree
...
Extracting templates from packages: 100%
Preconfiguring packages ...
Selecting previously unselected package ttf-dejavu-core.
</code></pre>

<p>晴れてインストール完了</p>

<h2>使ってみる</h2>

<ul>
<li>テキストファイル: 普通に開ける</li>
<li>画像ファイル: 開けるメソッドがなくエラー（環境立ち上げたばかりなので）</li>
</ul>


<h3>ディレクトリを指定</h3>

<pre><code class="bash">$ mkdir test
$ touch test/file
$ xdg-open test/
</code></pre>

<p><img src="/images/xdg_open/directory.png"></p>

<h3>URL を指定してみる</h3>

<pre><code class="bash">$ xdg-open http://blog.sojiro.me
</code></pre>

<p><img src="/images/xdg_open/blog.png"></p>

<pre><code class="bash">$ xdg-open http://google.com
</code></pre>

<p><img src="/images/xdg_open/google.png"></p>

<p>ブラウザはないが URL を指定すると CUI 上で Web ページが開ける</p>

<h2>参照</h2>

<ul>
<li><a href="http://blog.sojiro.me/blog/2015/05/03/the-first-step-for-vagrant/">初めてのVagrant</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[AWSのLinuxにMongoDBをインストール]]></title>
    <link href="http://sojiro14.github.io/blog/2014/12/30/installing-mongodb-on-linux-aws/"/>
    <updated>2014-12-30T13:32:15+09:00</updated>
    <id>http://sojiro14.github.io/blog/2014/12/30/installing-mongodb-on-linux-aws</id>
    <content type="html"><![CDATA[<p>AWSで借りたサーバーにmongoDBが入っていなかったのでインストールした手順</p>

<h2>YUMの設定</h2>

<p>パッケージ管理システムであるYUMにmongoDB用の設定を追加する
<code>bash
$ sudo vim /etc/yum.repos.d/mongodb.repo
</code>
<code>bash /etc/yum.repos.d/mongodb.repo
[mongodb]
name=MongoDB Repository
baseurl=http://downloads-distro.mongodb.org/repo/redhat/os/x86_64/
gpgcheck=0
enabled=1
</code>
これでYUMにmongoDBのリポジトリが追加される</p>

<!-- more -->


<h2>mongoDBのインストール</h2>

<p>今回は何も考えず最新のバージョンをインストールするので以下のコマンドで実行する
<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>sudo yum install mongodb-org
</span><span class='line'>読み込んだプラグイン:priorities, update-motd, upgrade-helper&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;<span class="p">&amp;</span>hellip<span class="p">;</span>&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt; Package                                                  アーキテクチャー                             バージョン                                       リポジトリー                                   容量&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;インストール中:
</span><span class='line'> mongodb-org                                              x86_64                                       2.6.6-1                                          mongodb                                       4.9 k
</span><span class='line'>依存性関連でのインストールをします:
</span><span class='line'> mongodb-org-mongos                                       x86_64                                       2.6.6-1                                          mongodb                                       6.8 M
</span><span class='line'> mongodb-org-server                                       x86_64                                       2.6.6-1                                          mongodb                                       9.0 M
</span><span class='line'> mongodb-org-shell                                        x86_64                                       2.6.6-1                                          mongodb                                       4.3 M
</span><span class='line'> mongodb-org-tools                                        x86_64                                       2.6.6-1                                          mongodb                                        <span class="m">90</span> M&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;トランザクションの要約&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;インストール  <span class="m">1</span> パッケージ <span class="o">(</span>+4 個の依存関係のパッケージ<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;総ダウンロード容量: <span class="m">110</span> M
</span><span class='line'>インストール容量: <span class="m">277</span> M
</span><span class='line'>Is this ok <span class="o">[</span>y/d/N<span class="o">]</span>: y
</span><span class='line'>Downloading packages:
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>完了しました!
</span></code></pre></td></tr></table></div></figure></p>

<h2>確認</h2>

<pre><code class="bash">$ mongo --version
MongoDB shell version: 2.6.6
</code></pre>

<p>インストール完了</p>

<h2>参照</h2>

<ul>
<li><a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-red-hat-centos-or-fedora-linux/">Install MongoDB on Red Hat Enterprise, CentOS, Fedora, or Amazon Linux</a></li>
<li><a href="http://qiita.com/nownabe/items/123a8fd04ff5252b3036">CentOS6.5にMongoDBをインストールする</a></li>
<li><a href="http://qiita.com/ykyk1218/items/1c1824e77fb8af78bcf5">MongoDBをLinuxにインストール</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[LinuxにRuby on Railsをインストールする]]></title>
    <link href="http://sojiro14.github.io/blog/2014/11/05/installing-ruby-on-rails-on-linux/"/>
    <updated>2014-11-05T03:58:11+09:00</updated>
    <id>http://sojiro14.github.io/blog/2014/11/05/installing-ruby-on-rails-on-linux</id>
    <content type="html"><![CDATA[<p>Ruby on Railsを使ってみたいと思い、AWSにインストールした手順。</p>

<h2>Ruby version 2.0.0 を RVMを使ってインストール</h2>

<p><a href="http://sojiro14.github.io/blog/2014/10/31/installing-latest-ruby-in-linux/">Linuxに最新のRubyをインストールする</a>を参照</p>

<h2>gemsetの作成</h2>

<blockquote><p>Rubyをインストールしたら、Railsのアプリケーションを実行するために必要な他のソフトウェア向けにシステムを構成する必要があります。通常、これはgemのインストールに関連します。gemとは自己完結型のRubyコードのパッケージです。バージョン番号の異なるgem同士がコンフリクトすることがあるため、一連のgemを自己完結的にまとめたgemsetというものを作成してバージョンを使い分けるのが便利です。
（引用: <a href="http://railstutorial.jp/chapters/beginning?version=4.0#top">Ruby on Rails チュートリアル</a>）</p></blockquote>

<p>以下のコマンドでgemsetを作成する。
<code>bash
$ rvm use 2.0.0@railstutorial_rails_4_0 --create --default
</code></p>

<blockquote><p>上のコマンドを実行すると、Ruby 2.0.0に関連付けられたrailstutorial_rails_4_0というgemsetを作成し (&ndash;create)、その場でgemsetを有効にし (use)、gemsetをデフォルトに設定 (&ndash;default) します。これにより、ターミナルウィンドウを開いたときに2.0.0@railstutorial_rails_4_0というRubyとgemsetの組み合わせが常に選択されるようになります。
（引用: <a href="http://railstutorial.jp/chapters/beginning?version=4.0#top">Ruby on Rails チュートリアル</a>）</p></blockquote>

<h2>RubyGemsのインストール</h2>

<p>AWSには始めからgemがインストールされていて、PATHは以下。
<code>bash
$ which gem
/usr/bin/gem
</code>
RVMでRubyをインストールするとPATHが上書きされる。
<code>bash
$ which gem
~/.rvm/rubies/ruby-2.0.0-p594/bin/gem
</code>
今回はチュートリアルに合わせてgemのバージョンを更新する
<code>bash
$ gem update --system 2.0.3
</code>
gemの設定ファイルである <code>.gemrc</code> に自動生成されるドキュメントである <code>ri</code> と <code>rdoc</code> の自動生成を抑制する設定をする
<code>bash
$ vim .gemrc
$ cat .gemrc
install: --no-rdoc --no-ri
update:  --no-rdoc --no-ri
</code></p>

<h2>Railsをインストールする</h2>

<p>いよいよRailsをインストールする
<code>bash
$ gem install rails --version 4.0.5
</code>
インストール完了。
以下のコマンドで確認する
<code>bash
$ rails -v
Rails 4.0.5
</code>
Railsがインストールされたことを確認できた</p>

<h2>参照</h2>

<p><a href="http://railstutorial.jp/chapters/beginning?version=4.0#top">Ruby on Rails チュートリアル</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linuxに最新のRubyをインストールする]]></title>
    <link href="http://sojiro14.github.io/blog/2014/10/31/installing-latest-ruby-in-linux/"/>
    <updated>2014-10-31T05:29:00+09:00</updated>
    <id>http://sojiro14.github.io/blog/2014/10/31/installing-latest-ruby-in-linux</id>
    <content type="html"><![CDATA[<p>Ruby on Railsを使ってみたいと思い、調べてみるとRails4ではRubyのバージョンは1.9以降が必須のようである。</p>

<p>自分がさくらで借りているサーバーではRubyのバージョンが1.8.7だったのでこれを新しくしてみた。</p>

<h2>RVMのインストール</h2>

<p>新しいRubyをインストールする前にRVM(Ruby Version Manager)をインストールする。これはRubyをバージョンごとに管理するツール
<code>bash
$ curl -L https://get.rvm.io | bash -s
</code></p>

<p>このコマンドで自分のホームディレクトリ以下に <code>.rvm/</code> が作られ、ここにRVMがインストールされる。</p>

<p>そして <code>.profile</code> <code>.bashrc</code> <code>.zshrc</code> にPATHを通す記述が追加される。</p>

<p>また、 <code>.bash_profile</code> <code>.zlogin</code> にRVMをロードする記述が追加される。</p>

<p>RVMのインストールが完了したらロードする。ここではbashを使っているので以下のようにする。
<code>bash
$ source .bash_profile
</code></p>

<h2>Rubyのインストール</h2>

<h3>さくらのレンタルサーバーでの失敗</h3>

<p>まずはRubyのインストールに必要なパーツを調べ、無ければインストールする。
以下のコマンドで必要なものをピックアップしインストールまで行ってくれる。
<code>bash
$ rvm requirements
/your/home/directry/.rvm/scripts/functions/support: line 314: rvm_debug: command not found
Checking requirements for freebsd.
Installing requirements for freebsd.
Updating system.
Installing required packages: automake, bison, readline, libyaml...
Error running 'requirements_freebsd_libs_install automake bison readline libyaml',
</code>
ここでErrorが発生。内容は必要なパッケージがインストールできなかったということ。
そこでFreeBSDのパッケージ管理コマンドである <code>pkg</code> コマンドを使ってインストールを試みる。</p>

<p>が、サーバーの設定的に自分でパッケージを追加することができなかったのでさくらのサーバーを断念してAWSに移行した。</p>

<h3>AWSに移行</h3>

<p>AWSに移行して <code>$ rvm requirements</code> までを実行する。（AWSは始めからRubyのバージョンが2.0.0だったが構わず実行）
ここでも <code>$ rvm requirements</code> が転ける。</p>

<p>そこで今度はCentOSだったので <code>yum</code> を使ってインストールを試みる。以下のコマンドは <code>$ rvm requirements</code> が教えてくれる。Errorの原因が <code>sudo</code> で実行していなかったことなので <code>sudo</code> 付きで実行する。
<code>bash
sudo yum install -y patch libyaml-devel libffi-devel glibc-headers autoconf gcc-c++ glibc-devel patch readline-devel zlib-devel openssl-devel automake libtool bison
</code>
これで成功。
<code>bash
$ rvm requirements
Checking requirements for amazon.
Requirements installation successful.
</code>
 <code>$ rvm requirements</code>も成功。</p>

<p>このサーバーではすでにバージョン2.0.0のRubyがインストールされていたが、RVMの配下に新たにバージョン2.0.0のRubyをインストールする。
<code>bash
$ rvm install 2.0.0 --with-openssl-dir=$HOME/.rvm/usr
</code>
インストール完了。</p>

<h2>参考</h2>

<p><a href="http://railstutorial.jp/chapters/beginning?version=4.0#top">Ruby on Rails チュートリアル</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Amazon Linux AMIにagをインストールした手順]]></title>
    <link href="http://sojiro14.github.io/blog/2014/08/25/howto-install-ag-in-amazon-linux-ami/"/>
    <updated>2014-08-25T23:38:16+09:00</updated>
    <id>http://sojiro14.github.io/blog/2014/08/25/howto-install-ag-in-amazon-linux-ami</id>
    <content type="html"><![CDATA[<p>AWSでWebサーバーを借りた。このサーバーに<code>ag</code>をインストールした際の手順。</p>

<h2>agとは</h2>

<p>ソースコードから特定のwordを検索する際に使うコマンド<code>grep</code>がより賢く改良されたのが<code>ack</code>コマンド。</p>

<p>この<code>ack</code>をさらに改良し、検索を高速化させたのが<code>ag</code>コマンド（正式名称:The Silver Searcher）である。</p>

<h2>Amazon Linux AMIへのインストール</h2>

<p>MacにはHomebrewを使って<code>brew install the_silver_searcher</code>とするだけで簡単に入れることができた。</p>

<p>AWSで借りたサーバーはAmazon Linux AMIという独自のイメージだったが、<code>yum</code>が使えるのでCentOSと同じ以下の手順で入れることができた。</p>

<h3>ディレクトリの作成とソースのダウンロード</h3>

<p>ソースをダウンロード、インストールするディレクトリを作成し、gitから<code>ag</code>のソースを持ってくる
<code>bash
$ mkdir -p $HOME/local/source
$ cd $HOME/local/source
$ git clone https://github.com/ggreer/the_silver_searcher
</code></p>

<h3>ソースをmakeするための準備</h3>

<p>対象のサーバーはまっさらな状態でコンパイラなどもなかったため、それぞれインストールする。</p>

<p>前述の通りAmazon Linux AMIではyumを使うことができる
<code>bash
$ sudo su -
yum -y groupinstall "Development Tools"
yum -y install pcre-devel xz-devel
exit
</code></p>

<h3>インストール</h3>

<p>コンパイルしてインストールする
<code>bash
$ cd $HOME/local/source/the_silver_searcher
$ ./build.sh
$ sudo make install
</code></p>

<h3>パスを通す</h3>

<pre><code class="bash">$ cd
$ vim .bashrc
$ cat .bashrc
...
export PATH=$HOME/local/bin:$PATH
...
$ source .bashrc
</code></pre>

<p>これで<code>ag</code>が使えるようになった</p>

<h2>参考</h2>

<ul>
<li><a href="https://github.com/ggreer/the_silver_searcher">the_silver_searcher</a></li>
<li><a href="http://qiita.com/sifue/items/55d0c5c11a0571af3b8e">grepやackよりも速いコード検索ツールのagをローカルビルドインストールする</a></li>
</ul>

]]></content>
  </entry>
  
</feed>
