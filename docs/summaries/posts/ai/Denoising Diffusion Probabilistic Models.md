---
title: Denoising Diffusion Probabilistic Models
date: 2020-12-16
comments: true
categories: [Computer Science, Machine Learning]
---

# Denoising Diffusion Probabilistic Models
- <https://arxiv.org/abs/2006.11239>
- <https://arxiv.org/pdf/2006.11239>

---

## 拡散確率モデルによるデノイジング (DDPM)

## 1. はじめに

この論文は、拡散確率モデル(Diffusion Probabilistic Models)と呼ばれる新しい生成モデルの手法を提案しています。この手法は、非平衡熱力学の考え方に触発されたもので、高品質な画像生成を実現しています。

## 2. 拡散確率モデルの基本概念

拡散確率モデルは以下の2つのプロセスから構成されます：

1. **前方プロセス**：データにノイズを少しずつ加えていき、最終的に完全なノイズにする。
2. **逆プロセス**：ノイズから少しずつ元のデータの構造を復元していく。

これらのプロセスはマルコフ連鎖として定式化され、逆プロセスを学習することで生成モデルを構築します。

## 3. モデルの詳細

### 3.1 前方プロセス

前方プロセスは以下の式で表されます：

q(x_1:T|x_0) = ∏^T_t=1 q(x_t|x_t-1)

ここで、q(x_t|x_t-1)はガウシアンノイズを加える過程を表します。

### 3.2 逆プロセス

逆プロセスは以下の式で表されます：

p_θ(x_0:T) = p(x_T) ∏^T_t=1 p_θ(x_t-1|x_t)

ここで、p_θ(x_t-1|x_t)は学習されるガウシアン遷移を表します。

### 3.3 学習目的関数

モデルの学習は変分下界(ELBO)の最適化によって行われます：

L = E_q[-log(p_θ(x_0:T) / q(x_1:T|x_0))]

## 4. 主要な貢献

1. 拡散モデルとデノイジングスコアマッチングの関係性を明らかにしました。
2. 重み付き変分下界という新しい目的関数を提案し、サンプル品質を向上させました。
3. 様々なアーキテクチャや画像データセットで高品質なサンプルを生成することに成功しました。

## 5. 実験結果

![Figure 1: CelebA-HQ 256×256 サンプル（左）と無条件 CIFAR10 サンプル（右）](https://github.com/user-attachments/assets/070dd54a-011a-4957-b854-21abf1e21001)

上図はCIFAR10データセットで生成されたサンプルです。

主な結果は以下の通りです：

- CIFAR10で教師なしInception scoreが9.46、FIDスコアが3.17を達成（当時の最高性能）
- CelebA-HQやLSUNデータセットでも高品質なサンプルを生成

## 6. 進歩的な圧縮と生成

DDPMは、データの圧縮と進歩的な生成にも応用できることが示されました：

1. **進歩的な圧縮**：モデルを使って、データを徐々に圧縮していく過程を実現できます。
2. **進歩的な生成**：ノイズから始めて、徐々に画像の詳細を生成していく過程を可視化できます。

## 7. 結論

拡散確率モデルは、高品質な画像生成が可能な新しい手法として提案されました。この手法は、既存の生成モデルと比較して競争力のある結果を示し、また理論的にも興味深い性質を持っています。今後、画像以外のデータモダリティへの応用や、他の機械学習システムへの組み込みなど、さらなる発展が期待されます。

---
もっとわかりやすく

## 1. はじめに

この論文は、「拡散確率モデル」という新しい方法で、コンピューターに本物そっくりの画像を作らせる研究についてです。

## 2. 拡散確率モデルって何？

この方法は、2つの重要な段階があります：

1. **ノイズを加える段階**：きれいな画像に少しずつノイズ（雑音）を加えていき、最後には完全なノイズにします。
2. **ノイズを取り除く段階**：ノイズから少しずつ元の画像らしい特徴を取り戻していきます。

コンピューターは2番目の段階を学習します。これができるようになると、ノイズから始めて本物そっくりの画像を作れるようになります。

## 3. どうやって学習するの？

コンピューターは、たくさんの本物の画像を見て、「ノイズを取り除く」方法を学びます。これは、少しずつノイズの少ない画像に変えていく方法を学ぶということです。

## 4. この研究の大切なポイント

1. この方法が他の似たような方法とどう関係しているかを明らかにしました。
2. より良い画像を作るための新しい学習方法を考え出しました。
3. いろいろな種類の画像でこの方法を試して、とてもきれいな画像を作ることができました。

## 5. 実験結果

![Figure 1: CelebA-HQ 256×256 サンプル（左）と無条件 CIFAR10 サンプル（右）](https://github.com/user-attachments/assets/070dd54a-011a-4957-b854-21abf1e21001)

この図は、コンピューターが作った顔の画像（左）と小さな物体の画像（右）です。とても本物そっくりですね。

研究者たちは、この方法で作った画像の質を数字で測りました。その結果、多くの場合で今までの方法より良い点数を取ることができました。

## 6. この方法の面白い使い方

1. **画像を少しずつ圧縮する**：大きなファイルサイズの画像を、少しずつ小さくしていけます。
2. **画像を少しずつ作る**：最初はぼんやりとした画像から始めて、だんだんはっきりとした画像に変化していく様子を見ることができます。

## 7. まとめ

この新しい方法は、とてもきれいな偽物の画像を作ることができます。今までの方法よりも良い結果が出ていて、科学的にも面白い特徴があります。将来は、画像以外のデータ（例えば音声など）でも使えるかもしれません。また、他の人工知能の研究にも役立つ可能性があります。
