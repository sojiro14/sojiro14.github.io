---
title: "SongCreator: Lyrics-based Universal Song Generation"
date: 2024-09-09
comments: true
categories: [Computer Science, Sound]
---

# SongCreator: Lyrics-based Universal Song Generation
- <https://arxiv.org/abs/2409.06029>
- <https://arxiv.org/pdf/2409.06029>

---
## 1. 研究の概要と重要性

この論文は、歌詞から高品質な歌声と伴奏を生成する「SongCreator」というシステムを提案しています。

### 1.1 主な特徴と革新性

- 歌声と伴奏を個別に、かつ協調して生成できる
- 様々な歌声生成タスクに対応可能
- 高品質な音楽生成を実現
- 歌詞に基づく制御が可能

### 1.2 システム概要図

![システム概要](https://github.com/user-attachments/assets/b03e8e0a-9f5d-40ec-8160-dadb128742a1)

この図は、SongCreatorのシステム全体を示しています。
- Stage I: 言語モデリングによる意味的トークンの生成
- Stage II: 生成された意味的トークンから実際の音声への変換

## 2. 技術的なブレークスルー

### 2.1 デュアルシーケンス言語モデル(DSLM)

DSLMは以下の特徴を持つ新しい言語モデルです：

1. 歌声と伴奏を別々のデコーダーで処理
2. 双方向クロスアテンション機構による相互影響の考慮
3. 様々な生成タスクに対応可能なアテンションマスク戦略

![DSLMアーキテクチャ](https://github.com/user-attachments/assets/5165d3b9-8402-4357-92cf-8b865affb50d)

### 2.2 アテンションマスク戦略

以下の複数のマスク戦略を実装：

1. セルフアテンション用
   - 因果的マスク
   - 非因果的マスク

2. 双方向クロスアテンション用
   - 双方向マスク(BR)
   - 伴奏から歌声へのマスク(A2V)
   - 歌声から伴奏へのマスク(V2A)
   - マスクなし

## 3. 対応可能なタスク

SongCreatorは以下の8つの主要タスクに対応：

1. 歌詞から歌声生成
2. 歌詞から歌のみ生成
3. 伴奏から歌全体生成
4. 歌声から曲全体生成
5. 音楽の継続生成
6. 歌編集
7. 歌声編集
8. 歌の中の歌声編集

## 4. 実験結果と評価

### 4.1 主な評価指標

- FAD (Fréchet Audio Distance)
- MCD (Mel Cepstral Distortion)
- SECS (Speaker Embedding Cosine Similarity)
- MOS (Mean Opinion Score)テスト

### 4.2 実験結果のハイライト

歌詞から歌声生成タスクでの評価結果：

| モデル | Musicality | Quality |
|-------|------------|---------|
| Ground Truth | 4.3 ± 0.04 | 4.09 ± 0.05 |
| MusicLM | 3.21 ± 0.09 | 3.25 ± 0.07 |
| SongCreator | 4.25 ± 0.05 | 4.08 ± 0.06 |

## 5. 制限事項と今後の課題

1. データ収集の制限による課題：
   - テキストによるジャンルやスタイルの制御が困難
   - データセットの質と量の制限

2. 技術的な制限：
   - 伴奏の影響による歌声の明瞭さの制限
   - 意味的表現の抽出精度の向上が必要

## 6. 社会的影響と倫理的考慮

### 6.1 ポジティブな影響
- コンテンツクリエイターの創作支援
- 音楽制作の効率化
- 専門家のワークフロー改善

### 6.2 潜在的なリスク
- 声の複製による誤用の可能性
- ディープフェイク音声への懸念
- 有害コンテンツ生成の可能性

## 7. 実装の詳細

### 7.1 モデルの構成
- 歌詞エンコーダー: 4層のTransformer
- 歌声・伴奏デコーダー: 各8層のDSLM
- 歌デコーダー: 4層のTransformer
- 総パラメータ数: 約631M

### 7.2 トレーニングデータ
- 約8,500時間の歌詞付き楽曲
- 約270,000曲
- 1.7M個の30秒以下のクリップに分割

## 8. まとめ

SongCreatorは、歌詞からの歌声生成において革新的なアプローチを提示し、高い性能を実証しました。特に：

1. デュアルシーケンス言語モデルの導入
2. 効果的なアテンションマスク戦略の実装
3. 多様なタスクへの対応能力
4. 高品質な音声生成の実現

これらの成果は、音楽生成技術の発展に大きく貢献する可能性を示しています。

---

SongCreatorが歌詞を自然に楽曲に乗せられる理由について、論文の重要なポイントを解説します：

## 1. デュアルシーケンス言語モデル(DSLM)の革新的な設計

### 1.1 独立した処理と協調の両立
- 歌声デコーダーと伴奏デコーダーを別々に設計
- 双方向クロスアテンション(BCA)による相互影響の考慮
- これにより、歌声と伴奏が互いを意識しながら生成される

### 1.2 歌詞エンコーダーの専門的な設計
- 4層のTransformerエンコーダーを使用
- 発音に関連する重要な情報を効果的に抽出
- クロスアテンション層で歌詞と歌声の緻密なアライメントを実現

## 2. 高度な学習戦略

### 2.1 マルチタスクトレーニング
- 歌詞から歌生成
- 伴奏から歌生成
- 歌声編集
これらの複数タスクを同時に学習することで、より豊かな表現力を獲得

### 2.2 アテンションマスク戦略
- 因果的マスク：歌声の連続性を保持
- 非因果的マスク：文脈の全体的な理解を促進
- 双方向マスク：歌声と伴奏の調和を実現

## 3. データ処理とトレーニングの工夫

### 3.1 大規模なデータセット
- 8,500時間の歌詞付き楽曲を使用
- 30秒以下のクリップに分割し、1.7M個のトレーニングデータを作成
- Voice Activity Detection(VAD)を用いた精密な分割

### 3.2 高度な音源分離
- Demucsを使用して歌声と伴奏を分離
- クリーンな学習データの確保
- 歌声と伴奏の関係性の正確な学習

## 4. 技術的な特徴

### 4.1 BEST-RQ（意味的トークン抽出）の活用
- 音声から意味的な特徴を効率的に抽出
- 歌詞、メロディ、リズムの情報を適切に符号化
- 高品質な音声生成のための基盤を提供

### 4.2 Latent Diffusion Model（音声生成）の活用
- 低次元の潜在空間での効率的な生成
- 計算コストの削減と生成の安定性向上
- 高品質な音声波形の生成を実現

これらの要素が総合的に作用することで、SongCreatorは歌詞を自然に楽曲に乗せることを実現しています。特に、DSLMによる歌声と伴奏の協調生成、そして複数の専門的なモジュールの連携が、違和感のない楽曲生成を可能にしている重要な要因となっています。

---

SongCreatorが自然な発音とリズムを実現できる理由について、論文の重要なポイントを解説します：

## 1. 歌詞エンコーダーの高度な設計

### 1.1 専用の歌詞処理機構
- 4層のTransformerエンコーダーを採用
- 1024次元の隠れ層サイズで豊かな表現を実現
- 発音とリズムに関する情報を効果的に抽出

### 1.2 クロスアテンション機構
```plaintext
歌詞エンコーダーの出力と歌声デコーダーの特徴の間で
クロスアテンションを実行し、緻密なアライメントを実現
```
- 歌詞と歌声の正確な対応付けを学習
- 発音タイミングの精密な制御が可能
- リズムに合わせた自然な歌詞の配置を実現

## 2. 高度な学習データの処理

### 2.1 精密なデータ分割
- Voice Activity Detection (VAD)を使用
- 歌詞のタイミングに基づく分割
- 30秒以下の適切な長さのクリップに分割

### 2.2 クリーンなトレーニングデータ
- Demucsによる高品質な音源分離
- 歌声と伴奏の明確な分離
- 発音とリズムの正確な学習を実現

## 3. デュアルシーケンス言語モデル(DSLM)の特徴

### 3.1 歌声デコーダーの専門的な設計
```plaintext
歌声デコーダー：
- 8層のDSLMレイヤー
- 1024次元の隠れ層サイズ
- 16のアテンションヘッド
```
- 発音の細かなニュアンスを学習
- リズムとの同期を維持
- 自然な歌唱表現の実現

### 3.2 アテンションマスク戦略の効果
- 因果的マスク：発音の連続性を保持
- 非因果的マスク：前後の文脈を考慮
- 双方向マスク：伴奏とのリズム同期を実現

## 4. BEST-RQとVector Quantizationの活用

### 4.1 効率的な特徴抽出
- 1024次元の潜在表現を抽出
- 50Hzのサンプリングレートで時間的な精度を確保
- 発音とリズムの情報を適切に符号化

### 4.2 ベクトル量子化の効果
- 16384のコードブックサイズ
- 32次元のコードブック
- 発音とリズムの離散的な表現を学習

## 5. 実装上の工夫

### 5.1 高いサンプリングレート
- 入力：24kHzのサンプリングレート
- 出力：44.1kHzの高品質な音声生成
- 発音の細かな特徴を保持

### 5.2 効率的な生成プロセス
- top-kサンプリングの採用（k=50）
- 温度パラメータ0.9で適度な多様性を確保
- 安定した生成を実現

## 6. 評価結果での裏付け

### 6.1 主観評価での高スコア
- Musicality: 4.25 ± 0.05
- Quality: 4.08 ± 0.06
これらの数値は、発音とリズムの自然さを示唆

### 6.2 既存モデルとの比較
- MusicLMやVALL-Eなどの最新モデルを上回る性能
- 特に歌詞の発音とリズムの面で優位性を示す

これらの要素が総合的に作用することで、SongCreatorは自然な発音とリズムを持つ楽曲生成を実現しています。特に、歌詞エンコーダーとDSLMの精密な設計、そして高品質なデータ処理が、違和感のない発音とリズムを可能にしている重要な要因となっています。

---

SongCreatorにおけるクロスアテンションについて詳しく解説します。

## 1. クロスアテンションの基本構造

### 1.1 論文での数式表現
```
Qv = HvWQv
Kv = HaWKv
Vv = HaWVv

Av = softmax(QvK⊤v/√dk + M)
```

### 1.2 主要コンポーネント
- Qv：クエリ行列（歌声デコーダーからの情報）
- Kv, Vv：キーと値の行列（伴奏デコーダーからの情報）
- Hv, Ha：各デコーダーの隠れ層の出力（T×dh次元）
- WQv, WKv, WVv：学習可能な重み行列（dh×dk次元）
- M：アテンションマスク行列

## 2. 3種類のクロスアテンション層

### 2.1 通常のクロスアテンション層（CA）
- 目的：歌詞情報と音声生成の連携
- 機能：
  - 歌詞エンコーダーの出力と各デコーダーの特徴を結びつける
  - 歌詞の意味的・音韻的情報を音声生成に反映

### 2.2 双方向クロスアテンション層（BCA）
- 目的：歌声と伴奏の相互影響の制御
- 特徴：
  - 歌声→伴奏、伴奏→歌声の双方向の情報流
  - 両方向の注意機構が対称的に設計

### 2.3 最終統合用クロスアテンション
- 目的：歌声と伴奏の最終的な調和
- 機能：
  - 歌デコーダーで両者の情報を統合
  - シームレスな音楽生成を実現

## 3. アテンションマスク戦略

### 3.1 マスクの種類と効果
```plaintext
マスクマトリックスM:
0: アテンション許可
-∞: アテンション禁止
```

### 3.2 主要なマスク戦略
1. 双方向マスク（BR）
   - 時刻tまでの相互アテンションを許可
   - 未来の情報への参照を防止

2. 伴奏→歌声マスク（A2V）
   - 伴奏の全情報を歌声生成に利用
   - 歌声から伴奏への影響を制限

3. 歌声→伴奏マスク（V2A）
   - 歌声の全情報を伴奏生成に利用
   - 伴奏から歌声への影響を制限

4. ノーマスク
   - 独立した生成が必要な場合に使用

## 4. クロスアテンションの効果

### 4.1 実験結果での検証
歌詞から歌生成タスクでのABXテスト結果：
- クロスアテンションあり：85%
- クロスアテンションなし：14%
- 優位性なし：1%

### 4.2 具体的な改善点
1. 歌声の品質向上
   - より自然な発音
   - メロディーとの調和

2. 伴奏との同期性向上
   - リズムの一貫性
   - テンポの維持

3. 全体的な楽曲の質の向上
   - 調和のとれた音楽表現
   - 自然な音楽の流れ

## 5. 技術的な実装詳細

### 5.1 アーキテクチャ設定
```plaintext
- 隠れ層サイズ: 1024
- アテンションヘッド数: 16
- フィードフォワード次元: 4096
- 最大コンテキスト長: 1500トークン
```

### 5.2 計算効率の考慮
- 効率的なアテンション計算
- メモリ使用の最適化
- 並列処理の活用

このように、SongCreatorのクロスアテンション機構は、歌声と伴奏の調和、そして歌詞との緻密な連携を実現する重要な要素となっています。特に、様々なマスク戦略と組み合わせることで、タスクに応じた柔軟な生成制御を可能にしています。
